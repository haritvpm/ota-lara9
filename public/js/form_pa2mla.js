(()=>{var e;function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function t(e,t,o){return(t=function(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!==r(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}new Vue({el:"#app",data:{isProcessing:!1,form:{},errors:{},myerrors:[],muloptions:designations,pen_names:pa2mlas,pen_names_to_desig_our:pen_names_to_desig,addedemployeedesigdisplay:""},created:function(){Vue.set(this.$data,"form",_form),this.sessionchanged()},mounted:function(){},computed:{configdate:function(){return{format:"DD-MM-YYYY"}},isActive:function(){}},watch:{},methods:(e={sessionchanged:function(){this.form.date_from=calenderdays2[this.form.session][0],this.form.date_to=calenderdays2[this.form.session][calenderdays2[this.form.session].length-1]},onChange:function(){this.myerrors=[],this.slotoptions=this.slotoptions,this.selectdaylabel=": "+calenderdaysmap[this.form.duty_date],this.form.overtime_slot=""},addRow:function(){var e=this;if(this.rowsvalid()){this.myerrors=[];var r=e.form.overtimes.length>0?e.form.overtimes[e.form.overtimes.length-1]:null;e.form.overtimes.push({pen:"",designation:"Personal Assistant to MLA",count:r?r.count:0,worknature:r?r.worknature:""}),this.$nextTick((function(){e.$refs["field-"+(e.form.overtimes.length-1)][0].$el.focus()}))}},removeElement:function(e){this.form.overtimes.splice(e,1),this.myerrors=[]},limitText:function(e){return"and ".concat(e," more")},asyncFind:_.debounce((function(e){this.mydelayedsearch(e),this.myerrors=[]}),500),mydelayedsearch:function(e){var r=this;e.length>=3&&axios.get(urlajaxpen+"/"+e).then((function(e){r.pen_names=e.data})).catch((function(e){alert(JSON.stringify(e.data))}))}},t(e,"limitText",(function(e){return"and ".concat(e," other countries")})),t(e,"changeSelect",(function(e,r){var t=this;this.myerrors=[];var o=this;o.$nextTick((function(){for(var r=o.form.overtimes.length-1;r>=0;r--)if(o.form.overtimes[r].pen==e){var s=o.pen_names_to_desig_our[e];if(void 0!==s)if(-1!=s.indexOf("Attendant"))o.form.overtimes[r].designation="Office Attendant",o.addedemployeedesigdisplay="";else{o.form.overtimes[r].designation="Personal Assistant to MLA";var i=o.form.overtimes[r].pen.indexOf("-");o.addedemployeedesigdisplay=o.form.overtimes[r].pen.substr(i+1)+" : "+s,-1!=s.toUpperCase().indexOf("RELIEVED")&&t.myerrors.push("Emp relieved. Check the dates and OT manually: "+o.form.overtimes[r].pen)}break}}))})),t(e,"checkDuplicates",(function(){for(var e=this,r={},t=0;t<e.form.overtimes.length;t++){if(null!=r[e.form.overtimes[t].pen])return this.myerrors.push("Duplicate name found: "+e.form.overtimes[t].pen),!1;r[e.form.overtimes[t].pen]=!0}return!0})),t(e,"rowsvalid",(function(){this.myerrors=[];var e=this;if(""==e.form.session||""==e.form.date_from||""==e.form.date_to)return this.$swal("Oops","Please select session/dates!","error"),!1;var r=e.form.date_from.split("-").map(Number),t=e.form.date_to.split("-").map(Number);if(new Date(r[2],r[1]-1,r[0])>new Date(t[2],t[1]-1,t[0]))return this.$swal("Oops","Date-from cannot be greater than Date-to!","error"),!1;if(-1==calenderdays2[e.form.session].indexOf(e.form.date_from)||-1==calenderdays2[e.form.session].indexOf(e.form.date_to))return this.$swal("Oops","Please select a valid from-date/to-date for the selected session","error"),!1;if(e.form.overtimes.some((function(e){return""==e.pen||""==e.designation||+e.count<=0})))return this.$swal("Oops","Fill all the required fields!","error"),!1;var o=calenderdays2[this.form.session].length;return e.form.overtimes.some((function(e){return+e.count>o}))?(this.myerrors.push("Total days cannot be more than "+o),!1):this.checkDuplicates()})),t(e,"create",(function(){if(!this.isProcessing)if(this.isProcessing=!0,this.rowsvalid()){var e=this;if(e.form.overtimes.length<=0)return this.$swal("Oops","Need at least one row!","error"),this.isProcessing=!1,!1;axios.post(urlformsubmit,e.form).then((function(r){r.data.created?window.location.href=urlformsucessredirect+"/"+r.data.id:e.isProcessing=!1})).catch((function(r){e.$swal({type:"error",title:"Error",text:"Please read the error(s) shown in red at the top",timer:2500});var t=r.response;e.isProcessing=!1,e.errors=t.data}))}else this.isProcessing=!1})),t(e,"update",(function(){if(this.rowsvalid()){var e=this;if(e.form.overtimes.length<=0)return this.$swal("Oops","Need at least one row!","error"),!1;this.isProcessing=!0;var r=urlformsubmit+"/"+e.form.id;axios.put(r,e.form).then((function(r){r.data.created?window.location.href=urlformsucessredirect+"/"+r.data.id:e.isProcessing=!1})).catch((function(r){e.$swal({type:"error",title:"Error",text:"Please read the error(s) shown in red at the top",timer:2500});var t=r.response;e.isProcessing=!1,e.errors=t.data}))}})),e)})})();